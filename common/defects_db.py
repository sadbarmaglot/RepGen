DEFECTS_DB = [
    {
        "label" : "разрушение и трещины в отмостке, растительность у здания",
        "type": "бетон",
        "location": "отмостка, зона примыкания",
        "damage_type": "трещины, разрушение, зарастание",
        "description": "Частичное разрушение, трещины в теле отмостки. Растительность на участках щелей в зонах примыкания отмостки к зданию.",
        "recommendation": "Выполнить устройство отмостки у здания по специально разработанному проекту в соответствии с рекомендациями СП 82.13330.2016"
    },
    {
        "label": "щели в зоне примыкания отмостки к зданию",
        "type": "бетон",
        "location": "отмостка, зона примыкания",
        "damage_type": "щели, разрушение примыкания",
        "description": "Образование щелей в зонах примыкания прилегающей территории к зданию",
        "recommendation": "Выполнить устройство отмостки у здания по специально разработанному проекту в соответствии с рекомендациями СП 82.13330.2016"
    },
    {
        "label": "отсутствие отмостки и зарастание территории",
        "type": "бетон",
        "location": "отмостка, зона примыкания",
        "damage_type": "нарушение эксплуатации, зарастание",
        "description": "Отсутствие отмостки на большей площади периметра здания. Наличие растительности и кустарников в непосредственной близости от стен здания.",
        "recommendation": "Очистить прилегающую территорию от растительности и кустарников. Выполнить устройство отмостки с уклоном от здания шириной не менее 1 метра с обеспечением отвода поверхностных вод."
    },
    {
        "label": "разрушение отделки и шелушение краски",
        "type": "отделка",
        "location": "фасад",
        "damage_type": "шелушение, разрушение отделочных слоёв",
        "description": "Разрушение отделочных слоёв, шелушение окрасочного слоя",
        "recommendation": "Выполнить косметический ремонт"
    },
    {
        "label": "поражение грибком и чёрная плесень",
        "type": "отделка",
        "location": "фасад",
        "damage_type": "биопоражение, плесень",
        "description": "Следы поражения грибком и образование чёрной плесени на поверхности отделочных материалов",
        "recommendation": "Очистить поврежденные участки от грибкового налёта и плесени. При проведении ремонтных работ антисептическую обработку материалов необходимо проводить с применением составов, обладающих комплексным защитным действием и использовать материалы, обладающие биостойкостью."
    },
    {
        "label": "увлажнение и деструкция кирпичной кладки",
        "type": "кирпич",
        "location": "фасад",
        "damage_type": "деструкция, биопоражение",
        "description": "Увлажнение и деструкция кирпичной кладки, биопоражения",
        "recommendation": "Выполнить косметический ремонт повреждённых участков. При проведении ремонтных работ антисептическую обработку материалов необходимо проводить с применением составов, обладающих комплексным защитным действием и использовать материалы, обладающие биостойкостью"
    },
    {
        "label": "замокание и высолы",
        "type": "кирпич",
        "location": "фасад",
        "damage_type": "замокание, высолы",
        "description": "Следы длительных замоканий, высолы на поверхности кирпичной кладки",
        "recommendation": "Провести химическое блокирование глубинных остаточных засолений в зонах высолов. Расчищенные участки в местах с высолами обработать пропиткой (как вариант, «Antisulfat» производства фирмы Bostik Findley). Произвести косметический ремонт поврежденных участков стен"
    },
    {
        "label": "деструкция отделки и выветривание кирпичной кладки",
        "type": "кирпич",
        "location": "фасад",
        "damage_type": "деструкция, выветривание кирпича, разрушение отделки",
        "description": "Деструкция отделочных слоев стен по фасадам здания. Разрушение, выветривание кирпича и раствора кирпичной кладки наружных стен на глубину до 30 мм",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, пыли и растительности, восстановить кирпичную кладку на участках деструкции. Выполнить оштукатуривание (как вариант, использовать санирующую ремонтную штукатурку К-30 Bostik) и окраску поверхности"
    },
    {
        "label": "деформация пожарной лестницы",
        "type": "металл",
        "location": "пожарная лестница",
        "damage_type": "деформация, коррозия, нарушение крепления",
        "description": "Деформация металлической пожарной лестницы.",
        "recommendation": "Выполнить замену металлической лестницы."
    },
    {
        "label": "коррозия металлических элементов",
        "type": "металл",
        "location": "металлические элементы",
        "damage_type": "коррозия, разрушение антикоррозионного слоя",
        "description": "Разрушение антикоррозионного слоя, поверхностная коррозия металлических элементов",
        "recommendation": "Очистить элементы от продуктов коррозии, восстановить антикоррозионный слой согласно рекомендациям СП 28.13330.2017."
    },
    {
        "label": "деформация металлических листов",
        "type": "металл",
        "location": "кровля",
        "damage_type": "деформация",
        "description": "Погиб металлических листов кровли",
        "recommendation": "По совокупности дефектов и повреждений выполнить ремонт кровли здания по специально разработанному проекту в соответствии с СП 17.13330.2017"
    },
    {
        "label": "коррозия металлических дверей",
        "type": "металл",
        "location": "двери",
        "damage_type": "коррозия",
        "description": "Разрушение антикоррозионного слоя, поверхностная коррозия металлических дверей",
        "recommendation": "Выполнить замену дверных заполнений здания"
    },
    {
        "label": "отсутствие защитных зонтов",
        "type": "кровля",
        "location": "технологические выпуски",
        "damage_type": "отсутствие элементов",
        "description": "Отсутствие защитных зонтов над технологическими выпусками",
        "recommendation": "Выполнить устройство зонтов над технологическими выпусками"
    },
    {
        "label": "вздутия и застой воды",
        "type": "рулонная гидроизоляция",
        "location": "кровля",
        "damage_type": "вздутия, застой воды, нарушение уклонов",
        "description": "Отслоения от основания, многочисленные вздутия с образованием воздушных пузырей. Участки со следами застоя воды на кровле здания, вызванные контруклонами кровли.",
        "recommendation": "По совокупности дефектов и повреждений выполнить ремонт кровли здания по специально разработанному проекту в соответствии с СП 17.13330.2017"
    },
    {
        "label": "разрушение примыкания к парапету",
        "type": "рулонная гидроизоляция",
        "location": "кровля",
        "damage_type": "отрыв гидроизоляции, разрушение примыканий, разгерметизация",
        "description": "Отсутствие герметичности, отрыв рулонной гидроизоляции от парапетов и стен здания, отсутствие прижимных планок на участках примыкания рулонной гидроизоляции к парапетам и стенам здания",
        "recommendation": "По совокупности дефектов и повреждений выполнить ремонт кровли здания по специально разработанному проекту в соответствии с СП 17.13330.2017"
    },
    {
        "label": "оголение и коррозия армирования",
        "type": "железобетон",
        "location": "плита покрытия",
        "damage_type": "разрушение защитного слоя, коррозия",
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонных плит покрытия",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "label": "оголение и коррозия армирования",
        "type": "железобетон",
        "location": "стеновая панель",
        "damage_type": "разрушение защитного слоя, коррозия",
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонных стеновых панелей",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "label": "трещины и разрушение заделки швов",
        "type": "железобетон",
        "location": "стеновая панель",
        "damage_type": "трещины",
        "description": "Трещины, разрушение заделки швов стеновых панелей здания",
        "recommendation": "Трещины расшить, отчистить от слабопрочного материала и пыли. Выполнить закладку внутрь шва изоляционного уплотнителя (как вариант, вилатерм) соответствующего диаметра и нанести слой герметизирующей мастики. Выполнить оштукатуривание и окраску поверхности"
    },
    {
        "label": "трещины",
        "type": "газобетон",
        "location": "газобетонные блоки",
        "damage_type": "трещины",
        "description": "Трещины в газобетонных блоках, шириной раскрытия до 2 мм",
        "recommendation": "Трещины расшить, очистить от слабопрочного материала, пыли и растительности. Выполнить инъектирование трещин в кирпичной кладке стен с применением безусадочных растворов под давлением (как вариант ЭМАКО)"
    },
    {
        "label": "разрушение плиточного покрытия",
        "type": "керамическая плитка",
        "location": "покрытие пола",
        "damage_type": "разрушение покрытия",
        "description": "Разрушение покрытия полов из керамической плитки",
        "recommendation": "Выполнить косметический ремонт полов здания"
    },
    {
        "label": "деструкция кирпичной кладки",
        "type": "кирпич",
        "location": "наружная стена",
        "damage_type": "деструкция",
        "description": "Участки деструкции материалов кирпичной кладки наружных стен на глубину до 70 мм в результате систематического замачивания атмосферными осадками и разрушения в период знакопеременных температур",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала. Произвести восстановление кирпичной кладки стен в местах выявленных повреждений"
    },
    {
        "label": "биопоражение стеновых панелей",
        "type": "железобетон",
        "location": "стеновая панель",
        "damage_type": "биопоражение",
        "description": "Биопоражение стеновых панелей.",
        "recommendation": "Выполнить косметический ремонт повреждённых участков. При проведении ремонтных работ антисептическую обработку материалов необходимо проводить с применением составов, обладающих комплексным защитным действием и использовать материалы, обладающие биостойкостью."
    },
    {
        "label": "биопоражение и осадка крыльца",
        "type": "бетон",
        "location": "крыльцо",
        "damage_type": "биопоражение, осадка",
        "description": "Биоповреждение, осадка крыльца.",
        "recommendation": "По совокупности дефектов выполнить замену конструкций входной группы по специально разработанному проекту."
    },
    {
        "label": "разрушение оконных блоков",
        "type": "стекло",
        "location": "фасад",
        "damage_type": "разрушение, утрата элементов",
        "description": "Разрушение оконных блоков.",
        "recommendation": "Выполнить замену заполнений оконных проёмов на участках разрушения"
    },
    {
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования керамзитобетонных панелей",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования балок монолитных железобетонных перекрытий",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонных колонн",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "description": "Разрушение защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонных перекрытий",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "description": "Следы замоканий на поверхности плит перекрытий в зоне межпанельных швов",
        "recommendation": "Выполнить косметический ремонт повреждённых участков"
    },
    {
        "description": "Следы длительного замокания стен. Деструкция отделочных слоев",
        "recommendation": "Выполнить косметический ремонт повреждённых участков"
    },
    {
        "description": "Следы длительного замокания перекрытий. Деструкция отделочных слоев",
        "recommendation": "Выполнить косметический ремонт повреждённых участков"
    },
    {
        "description": "Высолы на наружной поверхности кирпичной кладки стен здания.",
        "recommendation": "Провести химическое блокирование глубинных остаточных засолений в зонах высолов. Расчищенные участки в местах с высолами обработать пропиткой (как вариант, «Antisulfat» производства фирмы Bostik Findley). Произвести косметический ремонт поврежденных участков стен."
    },
    {
        "description": "Разрушение антикоррозионного слоя, слоистая коррозия металлических элементов с уменьшением толщины сечения",
        "recommendation": "Выполнить усиление повреждённых участков по специально разработанному проекту"
    },
    {
        "description": "Обветшание деревянных оконных заполнений, следы длительных замоканий деревянных элементов оконных переплетов, трещины, ослабление в сопряжениях, неплотный притвор, частичная утрата остекления оконных переплетов, биологическая коррозия деревянных рам",
        "recommendation": "Выполнить замену оконных заполнений по специально разработанному проекту"
    },
    {
        "description": "Отсутствие дверных заполнений, биологическая коррозия в зонах замоканий",
        "recommendation": "Выполнить замену дверных заполнений по специально разработанному проекту"
    },
    {
        "description": "Непроектное отверстие заделано с помощью металлического листа. Заделка выполнена некачественно и существует опасность обрушения! металлического листа",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона плит покрытия"
    },
    {
        "description": "Непроектные отверстия в плитах покрытия с разрушением защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонных плит покрытия в результате протечек",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона плит покрытия"
    },
    {
        "description": "Следы замоканий, высолы на поверхности стен и потолков",
        "recommendation": "По совокупности дефектов необходимо выполнить косметический ремонт отделочных слоёв внутренних помещений здания. Провести химическое блокирование глубинных остаточных засолений в зонах высолов. Расчищенные участки в местах с высолами обработать пропиткой (как вариант, «Antisulfat» производства фирмы Bostik Findley)."
    },
    {
        "description": "Разрушение керамической плитки на поверхности стен",
        "recommendation": "По совокупности дефектов необходимо выполнить косметический ремонт отделочных слоёв внутренних помещений здания"
    },
    {
        "description": "Отклонение кирпичной кладки от вертикальной оси до 52 мм. Отсутствие перевязки кирпичной кладки стенового ограждения с колоннами каркаса. Существующее усиление с помощью металлической обоймы не выполняет свою функцию в полной мере",
        "recommendation": "Выполнить демонтаж существующего участка стенового ограждения. Выполнить перекладку повреждённого участка кирпичной кладки стенового ограждения здания по специально разработанному проекту с обязательной перевязкой"
    },
    {
        "description": "Трещины по внутренней кирпичной стене, шириной раскрытия до 2мм",
        "recommendation": "Трещины расшить, очистить от слабопрочного материала, пыли и растительности. Выполнить инъектирование трещин в кирпичной кладке стен с применением безусадочных растворов под давлением (как вариант ЭМАКО).\nПо совокупности дефектов необходимо выполнить косметический ремонт отделочных слоёв внутренних помещений здания"
    },
    {
        "description": "Трещина в кирпичной перегородке, шириной раскрытия до 1,5 мм",
        "recommendation": "Трещины расшить, очистить от слабопрочного материала, пыли и растительности. Выполнить инъектирование трещин в кирпичной кладке стен с применением безусадочных растворов под давлением (как вариант ЭМАКО).\nПо совокупности дефектов необходимо выполнить косметический ремонт отделочных слоёв внутренних помещений здания"
    },
    {
        "description": "Следы увлажнения, высолы на поверхности кирпичной кладки в результате капиллярного подсоса кирпичной кладки",
        "recommendation": "Провести химическое блокирование глубинных остаточных засолений в зонах высолов. Расчищенные участки в местах с высолами обработать пропиткой (как вариант, «Antisulfat» производства фирмы Bostik Findley).\nПо совокупности дефектов необходимо выполнить косметический ремонт отделочных слоёв внутренних помещений здания"
    },
    {
        "description": "Продольные трещины в зоне прохода армирования и поперечные трещины в зоне закладных деталей в результате коррозии металлических элементов",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона. Выполнить усиление повреждённой колонны с помощью металлической обоймы (как вариант, из равнополочных уголков 75х75х6 по всему периметру)"
    },
    {
        "description": "Разрушение, трещины, сколы, утрата на участках площадью до 20 м2 покрытия полов из керамической плитки",
        "recommendation": "По совокупности дефектов необходимо выполнить ремонт с восстановлением покрытия пола"
    },
    {
        "description": "Системы холодного и горячего водоснабжения обследуемого здания частично утрачены.\nНеудовлетворительное состояние канализационных стояков (коррозия, подтеки в местах раструбных соединений).\nЧастичная утрата санитарно-технических приборов.\nСистема отопления обследуемого здания частично утрачена.\nСистема принудительной вентиляции частично утрачена и находится в неработоспособном состоянии.\nЭлектропроводки местами выполнены по временной схеме, на скрутках, не закреплены.\nПусковая аппаратура (штепсельные розетки, выключатели и т.д.) находится в изношенном состоянии и частично утрачены.",
        "recommendation": "По результатам обследования инженерных сетей здания установлено, что системы электрооборудования, электропроводки, системы отопления, вентиляции, водоснабжения, канализации находятся в неудовлетворительном состоянии: не соответствуют действующим нормам и нуждаются в замене. Для безопасной эксплуатации инженерных сетей здания рекомендуется выполнить полную их реконструкцию в соответствии с действующими нормативными документами. Все работы по ремонту и реконструкции инженерных сетей должны выполняться по специально разработанному проекту"
    },
    {
        "description": "Частичное разрушение отмостки. Растительность на участках щелей в зонах примыкания отмостки к зданию",
        "recommendation": "Выполнить устройство отмостки у здания по специально разработанному проекту в соответствии с рекомендациями СП 82.13330.2016"
    },
    {
        "description": "Складирование строительных материалов на прилегающей территории к зданию",
        "recommendation": "Очистить прилегающую территорию от складируемых строительных материалов"
    },
    {
        "description": "Сквозная коррозия металлических элементов. Деформации покрытия и стенового ограждения входных лестничных спусков. Возможно обрушение строительных конструкций",
        "recommendation": "Выполнить замену конструкций лестничных спусков в подвал здания по специально разработанному проекту.\nДо окончания выполнения ремонтных работ необходимо исключить доступ людей в зону возможного обрушения строительных конструкций, установить ограждения и запрещающие знаки: «опасная зона» и «проход запрещен» по ГОСТ 12.4.026-2015"
    },
    {
        "description": "Затопление помещений подвала водой на глубину до 30 см",
        "recommendation": "Выполнить мероприятия по предотвращению затоплений (выполнить ревизию узлов коммуникаций, выполнить капитальный ремонт кровли). Выполнить просушивание конструкций с последующим восстановлением отделочных слоев."
    },
    {
        "description": "Сеть наклонных, вертикальных и горизонтальных (местами сквозных) трещин в кирпичной кладке перегородок здания шириной раскрытия до 40 мм, вызванные неравномерной осадкой фундаментов и пола 1-го этажа на высоту до 30мм",
        "recommendation": "Выполнить демонтаж с последующим переустройством кирпичных перегородок по специально разработанному проекту"
    },
    {
        "description": "Разрушение отделочных слоёв полов, стен и потолков. Трещины в бетонных полах, шириной раскрытия до 2мм.",
        "recommendation": "Выполнить косметический ремонт повреждённых участков"
    },
    {
        "description": "Следы замоканий на поверхности перекрытий. Участки застоя воды на поверхности полов",
        "recommendation": "Провести ревизию инженерных систем.\nВыполнить ремонт кровли по специально разработанному проекту в соответствии с СП 17.13330.2017"
    },
    {
        "description": "Продольная трещина в теле сборной железобетонной плиты, шириной раскрытия до 3мм",
        "recommendation": "Выполнить демонтаж повреждённой сборной железобетонной плиты. Вместо демонтированной плиты выполнить устройство монолитного железобетонного участка по специально разработанному проекту"
    },
    {
        "description": "Вертикальные трещины в зонах примыкания стеновых панелей лестничной клетки к колоннам каркаса здания",
        "recommendation": "Выполнить косметический ремонт повреждённых участков"
    },
    {
        "description": "Механическое разрушение (непроектные отверстия под инженерные сети) защитного слоя бетона с оголением и поверхностной коррозией рабочего армирования железобетонной плиты",
        "recommendation": "Очистить поврежденные участки от отслаивающегося материала, арматуру от продуктов коррозии, восстановить защитный слой бетона"
    },
    {
        "description": "Продавливание плиты в результате силового воздействия. Разрушение защитного слоя бетона, вывалы с оголением и деформацией рабочего армирования.\nВозможно обрушение строительных конструкций",
        "recommendation": "Выполнить демонтаж повреждённых железобетонных плит. Вместо демонтированных плит выполнить устройство монолитных железобетонных участков по специально разработанному проекту.\nДо окончания выполнения ремонтных работ необходимо исключить доступ людей в зону возможного обрушения строительных конструкций, установить ограждения и запрещающие знаки: «опасная зона» и «проход запрещен» по ГОСТ 12.4.026-2015"
    },
    {
        "description": "Разрушение защитного слоя бетона в зоне прокладки инженерных сетей, вывалы с оголением и деформацией и коррозией рабочего армирования.\nВозможно обрушение строительных конструкций",
        "recommendation": "Выполнить демонтаж повреждённых железобетонных плит. Вместо демонтированных плит выполнить устройство монолитных железобетонных участков по специально разработанному проекту.\nДо окончания выполнения ремонтных работ необходимо исключить доступ людей в зону возможного обрушения строительных конструкций, установить ограждения и запрещающие знаки: «опасная зона» и «проход запрещен» по ГОСТ 12.4.026-2015"
    },
    {
        "description": "Непроектные отверстия под инженерные сети в кирпичной перегородке здания",
        "recommendation": "Выполнить восстановление целостности кирпичной кладки перегородки"
    },
    {
        "description": "Деструкция материалов заделки швов между сборными железобетонными плитами",
        "recommendation": "Швы расшить, очистить от слабопрочного материала, восстановить материал заделки швов плит покрытия."
    },
    {
        "description": "Образование вздутий рулонной гидроизоляции кровельного покрытия в результате затекания воды под слои гидроизоляционного покрытия, образование микротрещин в рулонном покрытии.  Участки со следами застоя воды на кровле, вызванные контруклонами кровли и засорением водоприёмных воронок",
        "recommendation": "По совокупности дефектов необходимо выполнить ремонт кровли здания по специально разработанному проекту в соответствии с СП 17.13330.2017"
    },
    {
        "description": "Частичная утрата, вывод из эксплуатации инженерных сетей здания (электроснабжения, водоснабжения, канализации, отопления, электроснабжений и сетей связи)",
        "recommendation": "Восстановить инженерные системы здания по специально разработанному проекту в соответствии с СП 30.13330.2020, СП 60.13330.2020,\nПУЭ (7-е издание)"
    }
]

DEFECTS_TEXT = "\n".join([
    f"- {d['description']} → {d['recommendation']}" for d in DEFECTS_DB
])

USER_PROMPT = f"""
Ты технический специалист. На фото — участок строительной конструкции с повреждением.

Вот база известных дефектов и рекомендаций:
{DEFECTS_TEXT}

Определи:
1. Какой дефект ты видишь?
2. Подбери наиболее подходящее описание дефекта из базы.
3. Верни также рекомендацию.

Ответ строго в JSON:
{{
  "description": "описание из базы",
  "recommendation": "соответствующее решение"
}}
"""

SYSTEM_PROMPT = "Ты помощник по техническому обследованию зданий."

# Промпт для определения типа конструкции
USER_PROMPT_CONSTRUCTIONS = """
Ты технический специалист по строительным конструкциям. На фото — участок строительной конструкции.

Определи тип конструкции из следующих вариантов:
- Фундаменты
- Стены
- Перекрытия
- Кровля
- Отмостка
- Крыльцо
- Балкон/лоджия
- Лестница
- Колонна
- Перемычка
- Другие конструкции

Ответ строго в JSON:
{
  "construction_type": "тип конструкции"
}
"""